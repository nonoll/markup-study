<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Start Rating</title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!--[if lt IE 9]>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
	<![endif]-->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">
	<link rel="stylesheet" href="./css/style.css">
</head>
<body>
	<h1 class="blind">StarRating</h1>
	<main>
		<!-- [D] data-value 기준 활성화 이미지 너비 설정 -->
		<div class="star-rating" data-value="0">
			<h2 class="blind">rating</h2>
			<!-- [D] range 값 변경시 값 변경 -->
			<strong class="star-rating__value">0.0</strong>
			<div class="star-rating__item">
				<input class="star-rating__item--slider" type="range" name="rating" min="0" max="5" step="0.5" value="0">
				<!-- [D] range 값에 비례하여 width % 값 설정 -->
				<span class="star-rating__item--active"></span>
			</div>
		</div>

		<div class="star-rating" data-value="3">
				<h2 class="blind">rating</h2>
				<!-- [D] range 값 변경시 값 변경 -->
				<strong class="star-rating__value">3.0</strong>
				<div class="star-rating__item">
					<input class="star-rating__item--slider" type="range" name="rating" min="0" max="5" step="0.5" value="3">
					<!-- [D] range 값에 비례하여 width % 값 설정 -->
					<span class="star-rating__item--active"></span>
				</div>
			</div>
	</main>

	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script src="./js/browser-update.js"></script>
	<script>
		;(function(win, $) {
			'use strict';

			var starRating = (function() {
				var defParams = {
					container : '.star-rating',
					value : '.star-rating__value',
					slider : '.star-rating__item--slider',
					active : '.star-rating__item--active'
				};
				return {
					init : function(opts) {
						this.opts = $.extend({}, defParams, opts);

						this.setElements();
						this.attachEvents();
						this.setDefaultDisplay();
					},
					setElements : function() {
						this.container = $(this.opts.container);
						this.slider = this.container.find(this.opts.slider);
					},
					attachEvents : function() {
						this.slider.on('change', $.proxy(this.onSliderChangeListener, this));
					},
					onSliderChangeListener : function(e) {
						var target = $(e.currentTarget),
						container = target.closest(this.opts.container),
						output = container.find(this.opts.value),
						active = container.find(this.opts.active),
						value = win.Number(target.val()),
						valuePer = (value / win.parseInt(target.attr('max'), 10)) * 100;

						output.text(value.toFixed(1));
						container.attr('data-value', valuePer);
						active.width(valuePer + '%');
					},
					setDefaultDisplay : function() {
						$.map(this.slider, $.proxy(function(slider) {
							$(slider).trigger('change');
						}, this));
					}
				};
			})();

			$(function() {
				starRating.init();
			});
		})(window, window.jQuery);
	</script>
</body>
</html>